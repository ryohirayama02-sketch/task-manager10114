<div class="member-progress-container">
  <div class="header">
    <h2>全メンバーの進捗</h2>
    <p>
      自身が所属するプロジェクトに属している全メンバーの進捗概要を一覧で確認
    </p>

    <!-- 期間ボタン -->
    <div class="header-actions">
      <button mat-button class="period-button">
        <mat-icon>date_range</mat-icon>
        期間
      </button>
    </div>
  </div>

  <!-- ローディング表示 -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>メンバー進捗を読み込み中...</p>
  </div>

  <!-- メンバー一覧 -->
  <div *ngIf="!isLoading && members.length > 0" class="members-list">
    <mat-card
      *ngFor="let member of members"
      class="member-card"
      (click)="goToMemberDetail(member.name)"
    >
      <mat-card-content>
        <div class="member-header">
          <h3 class="member-name">{{ member.name }}</h3>
          <span class="completion-rate"
            >完了率: {{ member.completionRate }}%</span
          >
        </div>

        <!-- 優先度ヘッダー -->
        <div class="priority-header">
          <span class="priority-label">優先度</span>
          <span class="priority-high">高</span>
          <span class="priority-medium">中</span>
          <span class="priority-low">低</span>
        </div>

        <!-- 優先度別タスク詳細 -->
        <div class="priority-breakdown">
          <div class="status-row completed">
            <div class="status-label">完了</div>
            <div class="status-total">{{ member.completedTasks }}件</div>
            <div class="priority-details">
              <div class="priority-item high">
                {{ member.completedByPriority.high }}
              </div>
              <div class="priority-item medium">
                {{ member.completedByPriority.medium }}
              </div>
              <div class="priority-item low">
                {{ member.completedByPriority.low }}
              </div>
            </div>
          </div>

          <div class="status-row in-progress">
            <div class="status-label">作業中</div>
            <div class="status-total">{{ member.inProgressTasks }}件</div>
            <div class="priority-details">
              <div class="priority-item high">
                {{ member.inProgressByPriority.high }}
              </div>
              <div class="priority-item medium">
                {{ member.inProgressByPriority.medium }}
              </div>
              <div class="priority-item low">
                {{ member.inProgressByPriority.low }}
              </div>
            </div>
          </div>

          <div class="status-row not-started">
            <div class="status-label">未着手</div>
            <div class="status-total">{{ member.notStartedTasks }}件</div>
            <div class="priority-details">
              <div class="priority-item high">
                {{ member.notStartedByPriority.high }}
              </div>
              <div class="priority-item medium">
                {{ member.notStartedByPriority.medium }}
              </div>
              <div class="priority-item low">
                {{ member.notStartedByPriority.low }}
              </div>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- メンバーがいない場合 -->
  <div *ngIf="!isLoading && members.length === 0" class="no-members">
    <mat-card>
      <mat-card-content>
        <div class="no-members-content">
          <mat-icon class="info-icon">info</mat-icon>
          <h3>メンバーが見つかりません</h3>
          <p>タスクに担当者が設定されていないか、タスクが存在しません。</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
