<h2>プロジェクト詳細</h2>

<div *ngIf="project; else loading" class="project-card">
  <div class="project-header">
    <div class="project-info">
      <h3>{{ project.projectName }}</h3>
      <p><strong>概要:</strong> {{ project.overview || "未設定" }}</p>
      <p><strong>期間:</strong> {{ project.startDate || "未設定" }}</p>
      <p><strong>メンバー:</strong> {{ project.members || "未設定" }}</p>
      <p><strong>タグ:</strong> {{ project.tags || "-" }}</p>
    </div>

    <!-- 進捗率円グラフ -->
    <div class="progress-section" *ngIf="projectProgress">
      <app-progress-circle
        [percentage]="projectProgress.progressPercentage"
        [completedTasks]="projectProgress.completedTasks"
        [totalTasks]="projectProgress.totalTasks"
        [size]="120"
        [strokeWidth]="8"
      ></app-progress-circle>
    </div>
  </div>

  <div class="project-actions">
    <!-- ✅ カード右下に＋タスクボタン -->
    <button
      mat-raised-button
      color="accent"
      class="add-task-button"
      (click)="openAddTaskDialog()"
    >
      ＋ タスク
    </button>
  </div>

  <!-- マイルストーン表示 -->
  <div
    *ngIf="project.milestones && project.milestones.length > 0"
    style="margin-top: 20px"
  >
    <h4>マイルストーン</h4>
    <div *ngFor="let milestone of project.milestones" class="milestone-item">
      <div class="milestone-date">
        {{ milestone.date | date : "yyyy/MM/dd" }}
      </div>
      <div class="milestone-name">{{ milestone.name }}</div>
    </div>
  </div>

  <div style="margin-top: 20px">
    <button mat-raised-button color="primary" (click)="openEditProjectDialog()">
      プロジェクト編集
    </button>
  </div>
</div>

<ng-template #loading>
  <p>読み込み中...</p>
</ng-template>
